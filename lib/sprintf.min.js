var sprintf=this.sprintf=function(){function h(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function b(e,t){for(var r=[];0<t;r[--t]=e);return r.join("")}var e=function(){return e.cache.hasOwnProperty(arguments[0])||(e.cache[arguments[0]]=e.parse(arguments[0])),e.format.call(null,e.cache[arguments[0]],arguments)};return e.format=function(e,t){var r,n,s,i,a,o,f,u=1,p=e.length,c="",l=[];for(n=0;n<p;n++)if("string"===(c=h(e[n])))l.push(e[n]);else if("array"===c){if((i=e[n])[2])for(r=t[u],s=0;s<i[2].length;s++){if(!r.hasOwnProperty(i[2][s]))throw sprintf('[sprintf] property "%s" does not exist',i[2][s]);r=r[i[2][s]]}else r=i[1]?t[i[1]]:t[u++];if(/[^s]/.test(i[8])&&"number"!=h(r))throw sprintf("[sprintf] expecting number but found %s",h(r));switch(i[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=i[7]?r.toExponential(i[7]):r.toExponential();break;case"f":r=i[7]?parseFloat(r).toFixed(i[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&i[7]?r.substring(0,i[7]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(i[8])&&i[3]&&0<=r?"+"+r:r,o=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",f=i[6]-String(r).length,a=i[6]?b(o,f):"",l.push(i[5]?r+a:a+r)}return l.join("")},e.cache={},e.parse=function(e){for(var t=e,r=[],n=[],s=0;t;){if(null!==(r=/^[^\x25]+/.exec(t)))n.push(r[0]);else if(null!==(r=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(r=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(r[2]){s|=1;var i=[],a=r[2],o=[];if(null===(o=/^([a-z_][a-z_\d]*)/i.exec(a)))throw"[sprintf] huh?";for(i.push(o[1]);""!==(a=a.substring(o[0].length));)if(null!==(o=/^\.([a-z_][a-z_\d]*)/i.exec(a)))i.push(o[1]);else{if(null===(o=/^\[(\d+)\]/.exec(a)))throw"[sprintf] huh?";i.push(o[1])}r[2]=i}else s|=2;if(3===s)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";n.push(r)}t=t.substring(r[0].length)}return n},e}(),vsprintf=this.vsprintf=function(e,t){return t.unshift(e),sprintf.apply(null,t)};